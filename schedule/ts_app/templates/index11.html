<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Schedule</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #ffffff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        h1 {
            text-align: center;
            color: #343a40;
        }

        .schedule-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .day-schedule {
            background: #f1f3f5;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .day-schedule:hover {
            transform: translateY(-5px);
        }

        .day-schedule h3 {
            margin: 0 0 10px;
            color: #495057;
        }

        .lesson-card {
            display: flex;
            align-items: center;
            gap: 15px;
            background: #ffffff;
            padding: 15px;
            margin-top: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .lesson-card img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .lesson-info {
            width: 100%;
        }

        .lesson-info p {
            margin: 5px 0;
            color: #212529;
        }

        .lesson-info p strong {
            color: #495057;
        }

        @media (max-width: 768px) {
            .lesson-card {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        .teacher-container {
            display: flex;
            align-items: center;
        }

        .time-lesson-container {
            width: 100%;
            display: flex;
            justify-content: space-between;

        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Weekly Schedule</h1>

        <div id="scheduleList" class="schedule-list"></div>

    </div>



    <script>
        const API_URL = "http://127.0.0.1:8000/api/groups/";
        const scheduleList = document.getElementById("scheduleList");
        const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

        async function fetchGroups() {
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error("Failed to fetch groups");
                }
                const groups = await response.json();
                displaySchedule(groups);
            } catch (error) {
                console.error("Error:", error);
                scheduleList.innerHTML = "<p>Failed to load schedule. Please try again later.</p>";
            }
        }

        function displaySchedule(groups) {
            scheduleList.innerHTML = "";
            daysOfWeek.forEach((day) => {
                const daySchedule = document.createElement("div");
                daySchedule.className = "day-schedule";
                daySchedule.innerHTML = `<h3>${day}</h3>`;

                let hasLessons = false;
                groups.forEach((group) => {
                    const dayLessons = group.lessons.filter((lesson) => lesson.day.toLowerCase() === day.substring(0, 3).toLowerCase());

                    if (dayLessons.length > 0) {
                        hasLessons = true;
                        dayLessons.forEach((lesson) => {
                            const teacher = group.teachers.find((t) => t.group === group.id) || group.teachers[0];
                            const lessonCard = document.createElement("div");
                            lessonCard.className = "lesson-card";
                            lessonCard.innerHTML = `
                                <h2>${group.name}</h2>
                                <div class="lesson-info">
                                    
                                    <p></p>
                                    <div class="time-lesson-container">
                                        <p><strong>Room:</strong> ${lesson.classroom}</p>
                                        <p><strong>${lesson.time}</strong></p>
                                    </div>
                                    <hr>
                                    <div class="teacher-container">
                                        <img src="${teacher.image}" alt="${teacher.name} ${teacher.surname}" class="teacher-image">
                                        <p><strong>${teacher.name} ${teacher.surname}</strong></p>
                                    </div>
                                    
                                </div>
                            `;
                            daySchedule.appendChild(lessonCard);
                        });
                    }
                });

                if (!hasLessons) {
                    daySchedule.innerHTML += "<p>No lessons scheduled</p>";
                }

                scheduleList.appendChild(daySchedule);
            });
        }

        fetchGroups();
    </script>
</body>

</html>